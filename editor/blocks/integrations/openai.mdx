---
title: OpenAI
---

import { LoomVideo } from '/snippets/loom-video.mdx'

## Criar finalizaÃ§Ã£o de chat

Com o bloco OpenAI, vocÃª pode criar uma finalizaÃ§Ã£o de chat com base nas consultas do usuÃ¡rio e exibir a resposta de volta para o seu bot.

<Frame>
  <img
    src="/images/blocks/integrations/openai/overview.png"
    alt="Bloco OpenAI"
  />
</Frame>

Esta integraÃ§Ã£o vem com um tipo de mensagem conveniente chamado **DiÃ¡logo**. Isso permite que vocÃª passe facilmente uma sequÃªncia de histÃ³rico de mensagens salvas do assistente/usuÃ¡rio para a OpenAI:

<Frame>
  <img
    src="/images/blocks/integrations/openai/append-to-history.png"
    alt="SequÃªncia de mensagens da OpenAI"
  />
</Frame>

Em seguida, vocÃª pode dar ao bloco OpenAI acesso a essa sequÃªncia de mensagens:

<Frame>
  <img
    src="/images/blocks/integrations/openai/dialogue-usage.png"
    alt="SequÃªncia de mensagens da OpenAI"
  />
</Frame>

### Ferramentas

A seÃ§Ã£o de ferramentas permite adicionar funÃ§Ãµes que o modelo OpenAI pode executar. Aqui estÃ¡ um exemplo de uma funÃ§Ã£o chamada `getWeather` que retorna 'Ensolarado e quente' se vocÃª perguntar sobre o clima de Paris e 'Chuvoso e frio' se vocÃª perguntar por qualquer outra cidade ğŸ˜‚.

Um exemplo mais Ãºtil seria, Ã© claro, chamar uma API para obter o clima da cidade sobre a qual o usuÃ¡rio estÃ¡ perguntando.

<Frame>
  <img src="/images/blocks/integrations/openai/tools.png" alt="Ferramentas da OpenAI" />
</Frame>

Como vocÃª pode ver, o bloco de cÃ³digo espera o corpo da funÃ§Ã£o JavaScript. VocÃª deve usar a palavra-chave `return` para retornar o valor para devolver Ã  OpenAI como resultado da funÃ§Ã£o.

Se vocÃª deseja definir variÃ¡veis diretamente neste bloco de cÃ³digo, pode usar a funÃ§Ã£o [`setVariable`](../logic/script#setvariable-function).

## Perguntar ao assistente

Esta aÃ§Ã£o permite conversar com seu [assistente OpenAI](https://platform.openai.com/assistants). Tudo que vocÃª precisa fazer Ã© fornecer seu ID.

Para que o seu bloco lembre do histÃ³rico da conversa, vocÃª precisa fornecer uma variÃ¡vel `Thread ID`. Se a variÃ¡vel estiver vazia, ele criarÃ¡ uma nova conversa e salvarÃ¡ automaticamente o novo ID da conversa na variÃ¡vel.

<LoomVideo id="daa20fcc5984472a875a3ad4d3fc2a3a" />

### FunÃ§Ãµes

Se vocÃª definiu funÃ§Ãµes em seu assistente, pode definir a funÃ§Ã£o a ser executada na seÃ§Ã£o `FunÃ§Ãµes`.

## Criar Ã¡udio

Esta aÃ§Ã£o permite transformar uma entrada de texto em uma URL de Ã¡udio que vocÃª pode reutilizar em seu bot.

:::note
As URLs de Ã¡udio geradas sÃ£o temporÃ¡rias e expiram apÃ³s 7 dias. Se precisar armazenÃ¡-las, certifique-se de baixÃ¡-las antes de expirarem.
:::

<LoomVideo id="ccca6cbf16ed4d01b513836775db06a3" />

## Usando MÃºltiplos Blocos Open AI: Dicas e Truques

Neste vÃ­deo, discuto algumas coisas importantes a ter em mente ao usar vÃ¡rios blocos Open AI consecutivamente. Eu forneÃ§o um exemplo onde perguntamos ao usuÃ¡rio sobre um tÃ³pico, geramos um resumo e exibimos uma lista de autores.

Explico que a transmissÃ£o de mensagens nÃ£o Ã© possÃ­vel quando elas sÃ£o prefixadas ou sufixadas por texto, e que todos os blocos precisam ser computados antes de exibir qualquer coisa.

TambÃ©m demonstro como a formataÃ§Ã£o pode ser afetada pela presenÃ§a de texto antes de uma mensagem. Assista a este vÃ­deo para aprender como otimizar o uso de vÃ¡rios blocos Open AI.

<LoomVideo id="35dc8af6b9244762acc4a5acf275fb43" />

## SoluÃ§Ã£o de problemas

### Mensagem de erro: "O bloco OpenAI retornou um erro"

Isso significa que seu bloco OpenAI nÃ£o estÃ¡ configurado corretamente. Verifique o seguinte:

- VocÃª selecionou uma conta OpenAI
- VocÃª tem pelo menos 1 mensagem de **usuÃ¡rio** ou uma mensagem de **DiÃ¡logo** configurada.

### Retorna uma mensagem vazia

Provavelmente significa que vocÃª excedeu sua cota gratuita da OpenAI. Adicione um mÃ©todo de pagamento Ã  sua conta OpenAI para continuar usando-a.
